// Í¥ëÍ≥† Î°úÎìú Ìï®Ïàò
function loadAds() {
    try {
        (adsbygoogle = window.adsbygoogle || []).push({});
    } catch (e) {
        console.log('AdSense loading error:', e);
    }
}

// ÏßàÎ¨∏ Ï§ëÍ∞Ñ Í¥ëÍ≥† ÌëúÏãú Ìï®Ïàò
function showQuestionMidAd() {
    const midAdElement = document.getElementById('questionMidAd');
    if (midAdElement) {
        midAdElement.style.display = 'block';
        // Í¥ëÍ≥† Î°úÎìú
        setTimeout(() => {
            loadAds();
        }, 100);
        
        // 3Ï¥à ÌõÑ Îã§Ïùå ÏßàÎ¨∏ÏúºÎ°ú
        setTimeout(() => {
            midAdElement.style.display = 'none';
            showQuestion(4);
        }, 3000);
    } else {
        showQuestion(4);
    }
}

// ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞
let currentQuestion = 0;
let answers = [];
const totalQuestions = 5;

// Ïπ¥Îìú Ï∂îÏ≤ú Îç∞Ïù¥ÌÑ∞
const cardRecommendations = {
    gsfuel: {
        name: "GSÏπºÌÖçÏä§ Î©ÄÌã∞Ïπ¥Îìú",
        features: [
            { icon: "‚õΩ", title: "GSÏπºÌÖçÏä§ Ìï†Ïù∏", desc: "Î¶¨ÌÑ∞Îãπ 100Ïõê Ìï†Ïù∏" },
            { icon: "üí≥", title: "Ïó∞ÌöåÎπÑ", desc: "2ÎßåÏõê (Ìï†Ïù∏ Ï°∞Í±¥ Ï∂©Ï°±Ïãú Î©¥Ï†ú)" },
            { icon: "üéØ", title: "ÌäπÌôî ÌòúÌÉù", desc: "GSÌé∏ÏùòÏ†ê 3% Ìï†Ïù∏" }
        ],
        benefits: ["Î¶¨ÌÑ∞Îãπ 100Ïõê Ìï†Ïù∏", "GSÌé∏ÏùòÏ†ê Ìï†Ïù∏", "ÏÑ∏Ï∞® Ìï†Ïù∏", "ÏûêÎèôÏ∞®Ïö©Ìíà Ìï†Ïù∏"],
        detailedInfo: {
            "Ìï†Ïù∏ ÌòúÌÉù": [
                "GSÏπºÌÖçÏä§ Ï£ºÏú†ÏÜåÏóêÏÑú Î¶¨ÌÑ∞Îãπ 100Ïõê Ìï†Ïù∏",
                "Ïõî ÏµúÎåÄ 5ÎßåÏõêÍπåÏßÄ Ìï†Ïù∏ Í∞ÄÎä•",
                "GSÌé∏ÏùòÏ†êÏóêÏÑú 3% Ìï†Ïù∏ (Ïõî ÏµúÎåÄ 3ÎßåÏõê)",
                "GSÏπºÌÖçÏä§ ÏÑ∏Ï∞®Ïû• 10% Ìï†Ïù∏"
            ],
            "Ïù¥Ïö© Ï°∞Í±¥": [
                "Ïõî Ï£ºÏú† Ìï†Ïù∏ ÌïúÎèÑ: 5ÎßåÏõê",
                "Ïó∞ÌöåÎπÑ: 2ÎßåÏõê (Ïó∞ 50ÎßåÏõê Ïù¥ÏÉÅ Ïù¥Ïö©Ïãú Î©¥Ï†ú)",
                "Ìï†Ïù∏ Ï†ÅÏö©: Ïã†Ïö©Ïπ¥Îìú Í≤∞Ï†úÏãú"
            ],
            "Ï∂îÍ∞Ä ÌòúÌÉù": [
                "ÏûêÎèôÏ∞®Î≥¥Ìóò Ìï†Ïù∏",
                "ÌÉÄÏù¥Ïñ¥ Ìï†Ïù∏",
                "Ï†ïÎπÑ ÏÑúÎπÑÏä§ Ìï†Ïù∏",
                "Î°úÎìúÏñ¥ÏãúÏä§ÌÑ¥Ïä§ ÏÑúÎπÑÏä§"
            ]
        }
    },
    skoil: {
        name: "SKÏóêÎÑàÏßÄ ÏßÅÎ∂àÏπ¥Îìú",
        features: [
            { icon: "‚õΩ", title: "SKÏóêÎÑàÏßÄ Ìï†Ïù∏", desc: "Î¶¨ÌÑ∞Îãπ 120Ïõê Ìï†Ïù∏" },
            { icon: "üí≥", title: "Ïó∞ÌöåÎπÑ", desc: "Î¨¥Î£å" },
            { icon: "üéØ", title: "ÌäπÌôî ÌòúÌÉù", desc: "OKÏ∫êÏâ¨Î∞± Ï†ÅÎ¶Ω" }
        ],
        benefits: ["Î¶¨ÌÑ∞Îãπ 120Ïõê Ìï†Ïù∏", "Ïó∞ÌöåÎπÑ Î¨¥Î£å", "OKÏ∫êÏâ¨Î∞± Ï†ÅÎ¶Ω", "SKÏä§ÌîºÎìúÎ©îÏù¥Ìä∏ Ìï†Ïù∏"],
        detailedInfo: {
            "Ìï†Ïù∏ ÌòúÌÉù": [
                "SKÏóêÎÑàÏßÄ Ï£ºÏú†ÏÜåÏóêÏÑú Î¶¨ÌÑ∞Îãπ 120Ïõê Ìï†Ïù∏",
                "Ïõî ÏµúÎåÄ 6ÎßåÏõêÍπåÏßÄ Ìï†Ïù∏ Í∞ÄÎä•",
                "OKÏ∫êÏâ¨Î∞± 1% Ï†ÅÎ¶Ω (Ïõî ÏµúÎåÄ 2ÎßåÏõê)",
                "SKÏä§ÌîºÎìúÎ©îÏù¥Ìä∏ Ï†ïÎπÑ 5% Ìï†Ïù∏"
            ],
            "Ïù¥Ïö© Ï°∞Í±¥": [
                "Ïõî Ï£ºÏú† Ìï†Ïù∏ ÌïúÎèÑ: 6ÎßåÏõê",
                "Ïó∞ÌöåÎπÑ: Î¨¥Î£å",
                "Ìï†Ïù∏ Ï†ÅÏö©: ÏßÅÎ∂àÏπ¥Îìú Í≤∞Ï†úÏãú"
            ],
            "Ï∂îÍ∞Ä ÌòúÌÉù": [
                "SKÎ†åÌÑ∞Ïπ¥ Ìï†Ïù∏",
                "SKÏ£ºÏú†ÏÜå ÏÑ∏Ï∞® Ìï†Ïù∏",
                "ÏûêÎèôÏ∞®Ïö©Ìíà Ìï†Ïù∏",
                "Ï£ºÏ∞®Ïû• Ìï†Ïù∏ ÏÑúÎπÑÏä§"
            ]
        }
    },
    soil: {
        name: "S-OIL Î≥¥ÎÑàÏä§Ïπ¥Îìú",
        features: [
            { icon: "‚õΩ", title: "S-OIL Ìï†Ïù∏", desc: "Î¶¨ÌÑ∞Îãπ 80Ïõê Ìï†Ïù∏" },
            { icon: "üí≥", title: "Ïó∞ÌöåÎπÑ", desc: "1ÎßåÏõê" },
            { icon: "üéØ", title: "ÌäπÌôî ÌòúÌÉù", desc: "Î≥¥ÎÑàÏä§ Ìè¨Ïù∏Ìä∏ Ï†ÅÎ¶Ω" }
        ],
        benefits: ["Î¶¨ÌÑ∞Îãπ 80Ïõê Ìï†Ïù∏", "Î≥¥ÎÑàÏä§ Ìè¨Ïù∏Ìä∏ Ï†ÅÎ¶Ω", "ÏÑ∏Ï∞® Ìï†Ïù∏", "Ìé∏ÏùòÏ†ê Ìï†Ïù∏"],
        detailedInfo: {
            "Ìï†Ïù∏ ÌòúÌÉù": [
                "S-OIL Ï£ºÏú†ÏÜåÏóêÏÑú Î¶¨ÌÑ∞Îãπ 80Ïõê Ìï†Ïù∏",
                "Ïõî ÏµúÎåÄ 4ÎßåÏõêÍπåÏßÄ Ìï†Ïù∏ Í∞ÄÎä•",
                "Î≥¥ÎÑàÏä§ Ìè¨Ïù∏Ìä∏ 1% Ï†ÅÎ¶Ω",
                "S-OIL ÏÑ∏Ï∞®Ïû• 15% Ìï†Ïù∏"
            ],
            "Ïù¥Ïö© Ï°∞Í±¥": [
                "Ïõî Ï£ºÏú† Ìï†Ïù∏ ÌïúÎèÑ: 4ÎßåÏõê",
                "Ïó∞ÌöåÎπÑ: 1ÎßåÏõê (Ïó∞ 30ÎßåÏõê Ïù¥ÏÉÅ Ïù¥Ïö©Ïãú Î©¥Ï†ú)",
                "Ìï†Ïù∏ Ï†ÅÏö©: Ïπ¥Îìú Í≤∞Ï†úÏãú"
            ],
            "Ï∂îÍ∞Ä ÌòúÌÉù": [
                "Ìé∏ÏùòÏ†ê 2% Ìï†Ïù∏",
                "Ïπ¥Ìéò Ìï†Ïù∏",
                "ÏûêÎèôÏ∞®Î≥¥Ìóò Ìï†Ïù∏",
                "Ï†ïÎπÑ ÏÑúÎπÑÏä§ Ìï†Ïù∏"
            ]
        }
    },
    hyundai: {
        name: "ÌòÑÎåÄÏò§ÏùºÎ±ÖÌÅ¨ POINTÏπ¥Îìú",
        features: [
            { icon: "‚õΩ", title: "ÌòÑÎåÄÏò§ÏùºÎ±ÖÌÅ¨ Ìï†Ïù∏", desc: "Î¶¨ÌÑ∞Îãπ 90Ïõê Ìï†Ïù∏" },
            { icon: "üí≥", title: "Ïó∞ÌöåÎπÑ", desc: "1.5ÎßåÏõê" },
            { icon: "üéØ", title: "ÌäπÌôî ÌòúÌÉù", desc: "H-Point Ï†ÅÎ¶Ω" }
        ],
        benefits: ["Î¶¨ÌÑ∞Îãπ 90Ïõê Ìï†Ïù∏", "H-Point Ï†ÅÎ¶Ω", "ÏÑ∏Ï∞® Ìï†Ïù∏", "Ï†ïÎπÑ Ìï†Ïù∏"],
        detailedInfo: {
            "Ìï†Ïù∏ ÌòúÌÉù": [
                "ÌòÑÎåÄÏò§ÏùºÎ±ÖÌÅ¨ Ï£ºÏú†ÏÜåÏóêÏÑú Î¶¨ÌÑ∞Îãπ 90Ïõê Ìï†Ïù∏",
                "Ïõî ÏµúÎåÄ 4.5ÎßåÏõêÍπåÏßÄ Ìï†Ïù∏ Í∞ÄÎä•",
                "H-Point 1% Ï†ÅÎ¶Ω",
                "ÌòÑÎåÄÏò§ÏùºÎ±ÖÌÅ¨ ÏÑ∏Ï∞®Ïû• 10% Ìï†Ïù∏"
            ],
            "Ïù¥Ïö© Ï°∞Í±¥": [
                "Ïõî Ï£ºÏú† Ìï†Ïù∏ ÌïúÎèÑ: 4.5ÎßåÏõê",
                "Ïó∞ÌöåÎπÑ: 1.5ÎßåÏõê (Ïó∞ 40ÎßåÏõê Ïù¥ÏÉÅ Ïù¥Ïö©Ïãú Î©¥Ï†ú)",
                "Ìï†Ïù∏ Ï†ÅÏö©: Ïπ¥Îìú Í≤∞Ï†úÏãú"
            ],
            "Ï∂îÍ∞Ä ÌòúÌÉù": [
                "Ï†ïÎπÑ ÏÑúÎπÑÏä§ Ìï†Ïù∏",
                "ÌÉÄÏù¥Ïñ¥ Ìï†Ïù∏",
                "ÏûêÎèôÏ∞®Ïö©Ìíà Ìï†Ïù∏",
                "Í≥†ÏÜçÎèÑÎ°ú Ìï†Ïù∏"
            ]
        }
    },
    premium: {
        name: "ÌîÑÎ¶¨ÎØ∏ÏóÑ Ï£ºÏú†Ïπ¥Îìú (Îã§Ï§ë Î∏åÎûúÎìú)",
        features: [
            { icon: "‚õΩ", title: "Ï†Ñ Î∏åÎûúÎìú Ìï†Ïù∏", desc: "Î¶¨ÌÑ∞Îãπ 60Ïõê Ìï†Ïù∏" },
            { icon: "üí≥", title: "Ïó∞ÌöåÎπÑ", desc: "3ÎßåÏõê" },
            { icon: "üéØ", title: "ÌäπÌôî ÌòúÌÉù", desc: "Îã§ÏñëÌïú Î∂ÄÍ∞Ä ÏÑúÎπÑÏä§" }
        ],
        benefits: ["Ï†Ñ Ï£ºÏú†ÏÜå Ìï†Ïù∏", "ÎÜíÏùÄ Ï∫êÏãúÎ∞±", "Îã§ÏñëÌïú Ï†úÌú¥ Ìï†Ïù∏", "ÌîÑÎ¶¨ÎØ∏ÏóÑ ÏÑúÎπÑÏä§"],
        detailedInfo: {
            "Ìï†Ïù∏ ÌòúÌÉù": [
                "Ï†ÑÍµ≠ Î™®Îì† Ï£ºÏú†ÏÜåÏóêÏÑú Î¶¨ÌÑ∞Îãπ 60Ïõê Ìï†Ïù∏",
                "Ïõî ÏµúÎåÄ 8ÎßåÏõêÍπåÏßÄ Ìï†Ïù∏ Í∞ÄÎä•",
                "ÏÉùÌôúÎπÑ 1% Ï∫êÏãúÎ∞±",
                "Ïò®ÎùºÏù∏ ÏáºÌïë 2% Ìï†Ïù∏"
            ],
            "Ïù¥Ïö© Ï°∞Í±¥": [
                "Ïõî Ï£ºÏú† Ìï†Ïù∏ ÌïúÎèÑ: 8ÎßåÏõê",
                "Ïó∞ÌöåÎπÑ: 3ÎßåÏõê (Ïó∞ 100ÎßåÏõê Ïù¥ÏÉÅ Ïù¥Ïö©Ïãú 50% Ìï†Ïù∏)",
                "Ìï†Ïù∏ Ï†ÅÏö©: Ïπ¥Îìú Í≤∞Ï†úÏãú"
            ],
            "Ï∂îÍ∞Ä ÌòúÌÉù": [
                "Í≥µÌï≠ ÎùºÏö¥ÏßÄ Ïù¥Ïö©",
                "Ìò∏ÌÖî Ìï†Ïù∏",
                "Î†åÌÑ∞Ïπ¥ Ìï†Ïù∏",
                "Ìï¥Ïô∏ Ïó¨Ìñâ Î≥¥Ìóò",
                "24ÏãúÍ∞Ñ Î°úÎìúÏñ¥ÏãúÏä§ÌÑ¥Ïä§"
            ]
        }
    }
};

// DOM ÏöîÏÜåÎì§
const startBtn = document.getElementById('startBtn');
const questions = document.querySelectorAll('.question');
const result = document.getElementById('result');
const analysisPopup = document.getElementById('analysisPopup');
const shareKakaoBtn = document.getElementById('shareKakao');
const restartBtn = document.getElementById('restartBtn');

// ÌÖåÏä§Ìä∏ ÏãúÏûë
startBtn.addEventListener('click', startTest);

function startTest() {
    document.querySelector('.question-container').style.display = 'none';
    showQuestion(1);
}

// ÏßàÎ¨∏ ÌëúÏãú
function showQuestion(questionNum) {
    const question = document.getElementById(`question${questionNum}`);
    if (question) {
        question.style.display = 'block';
        
        const answerBtns = question.querySelectorAll('.answer-btn');
        answerBtns.forEach(btn => {
            btn.addEventListener('click', () => selectAnswer(btn.dataset.score, questionNum));
        });
    }
}

// ÎãµÎ≥Ä ÏÑ†ÌÉù
function selectAnswer(score, questionNum) {
    answers.push(score);
    
    // ÌòÑÏû¨ ÏßàÎ¨∏ Ïà®Í∏∞Í∏∞
    document.getElementById(`question${questionNum}`).style.display = 'none';
    
    if (questionNum < totalQuestions) {
        // ÏßàÎ¨∏ 3Î≤à ÌõÑÏóê Í¥ëÍ≥† ÌëúÏãú
        if (questionNum === 3) {
            showQuestionMidAd();
        } else {
            showQuestion(questionNum + 1);
        }
    } else {
        showAnalysis();
    }
}

// Î∂ÑÏÑù ÌôîÎ©¥ ÌëúÏãú
function showAnalysis() {
    analysisPopup.style.display = 'block';
    
    // Î∂ÑÏÑù ÌåùÏóÖ Í¥ëÍ≥† Î°úÎìú
    setTimeout(() => {
        loadAds();
    }, 500);
    
    const loadingTexts = [
        'Ï£ºÏú†ÏÜåÎ≥Ñ Ìï†Ïù∏Ïú® Î∂ÑÏÑù Ï§ë...',
        'ÎãπÏã†Ïùò ÏÇ¨Ïö© Ìå®ÌÑ¥ Î∂ÑÏÑù Ï§ë...',
        'ÏµúÏ†ÅÏùò Ïπ¥Îìú ÏÑ†Î≥Ñ Ï§ë...',
        'ÌòúÌÉù Í≥ÑÏÇ∞ Ï§ë...',
        'ÏµúÏ¢Ö Ï∂îÏ≤ú Ï§ÄÎπÑ Ï§ë...'
    ];
    
    let textIndex = 0;
    let countdown = 5;
    
    const textInterval = setInterval(() => {
        document.getElementById('loadingText').textContent = loadingTexts[textIndex];
        textIndex = (textIndex + 1) % loadingTexts.length;
    }, 1000);
    
    const countdownInterval = setInterval(() => {
        countdown--;
        document.getElementById('countdown').textContent = countdown;
        
        if (countdown <= 0) {
            clearInterval(textInterval);
            clearInterval(countdownInterval);
            analysisPopup.style.display = 'none';
            showResult();
        }
    }, 1000);
}

// Í≤∞Í≥º ÌëúÏãú
function showResult() {
    const recommendation = calculateRecommendation();
    const card = cardRecommendations[recommendation];
    
    // Ïπ¥Îìú Ïù¥Î¶Ñ
    document.getElementById('cardName').textContent = card.name;
    
    // Ïπ¥Îìú ÌäπÏßï
    const featuresHTML = card.features.map(feature => 
        `<div class="feature-item">
            <div class="feature-icon">${feature.icon}</div>
            <h4>${feature.title}</h4>
            <p>${feature.desc}</p>
        </div>`
    ).join('');
    document.getElementById('cardFeatures').innerHTML = featuresHTML;
    
    // Ïπ¥Îìú ÌòúÌÉù
    const benefitsHTML = `
        <h4>Ï£ºÏöî ÌòúÌÉù</h4>
        <div class="benefit-list">
            ${card.benefits.map(benefit => `<span class="benefit-tag">${benefit}</span>`).join('')}
        </div>
    `;
    document.getElementById('cardBenefits').innerHTML = benefitsHTML;
    
    // ÏÉÅÏÑ∏ Ï†ïÎ≥¥
    const detailedHTML = Object.entries(card.detailedInfo).map(([title, items]) =>
        `<div class="info-section">
            <h4>${title}</h4>
            <ul>
                ${items.map(item => `<li>${item}</li>`).join('')}
            </ul>
        </div>`
    ).join('');
    document.getElementById('detailedBenefits').innerHTML = detailedHTML;
    
    result.style.display = 'block';
    
    // Í≤∞Í≥º ÌéòÏù¥ÏßÄ Í¥ëÍ≥† Î°úÎìú
    setTimeout(() => {
        loadAds();
    }, 1000);
}

// Ï∂îÏ≤ú ÏïåÍ≥†Î¶¨Ï¶ò
function calculateRecommendation() {
    const answerCounts = {};
    
    // ÎãµÎ≥Ä ÎπàÎèÑ Í≥ÑÏÇ∞
    answers.forEach(answer => {
        answerCounts[answer] = (answerCounts[answer] || 0) + 1;
    });
    
    // Ï£ºÏú†ÏÜåÎ≥Ñ ÏÑ†Ìò∏ÎèÑ Ï≤¥ÌÅ¨
    if (answers[0] === 'gsfuel') return 'gsfuel';
    if (answers[0] === 'skoil') return 'skoil';
    if (answers[0] === 'soil') return 'soil';
    if (answers[0] === 'hyundai') return 'hyundai';
    
    // ÏÇ¨Ïö©ÎüâÏóê Îî∞Î•∏ Ï∂îÏ≤ú
    if (answers[1] === 'veryhigh' || answers[1] === 'high') {
        return 'premium';
    }
    
    // ÌòúÌÉù ÏÑ†Ìò∏ÎèÑÏóê Îî∞Î•∏ Ï∂îÏ≤ú
    if (answers[2] === 'discount') {
        return 'skoil'; // Í∞ÄÏû• ÎÜíÏùÄ Ìï†Ïù∏Ïú®
    }
    
    if (answers[2] === 'cashback') {
        return 'premium';
    }
    
    // ÏÇ¨Ïö© Ìå®ÌÑ¥Ïóê Îî∞Î•∏ Ï∂îÏ≤ú
    if (answers[3] === 'business') {
        return 'premium';
    }
    
    // Í∏∞Î≥∏ Ï∂îÏ≤ú
    return 'gsfuel';
}

// Ïπ¥Ïπ¥Ïò§ÌÜ° Í≥µÏú†
shareKakaoBtn.addEventListener('click', function() {
    try {
        Kakao.Link.sendDefault({
            objectType: 'feed',
            content: {
                title: '‚õΩ ÌòúÌÉùÌÅ∞ Ï£ºÏú†Ìï†Ïù∏Ïπ¥Îìú Ï∂îÏ≤ú',
                description: 'ÎÇòÏóêÍ≤å ÎßûÎäî ÏµúÍ≥†Ïùò Ï£ºÏú†Ïπ¥ÎìúÎ•º Ï∞æÏïòÏñ¥Ïöî! ÎãπÏã†ÎèÑ ÌÖåÏä§Ìä∏Ìï¥Î≥¥ÏÑ∏Ïöî!',
                imageUrl: 'https://sd2624.github.io/Ï£ºÏú†Ìï†Ïù∏Ïπ¥Îìú/Ï£ºÏú†Ìï†Ïù∏Ïπ¥Îìú.svg',
                link: {
                    mobileWebUrl: window.location.href,
                    webUrl: window.location.href
                }
            },
            buttons: [
                {
                    title: 'ÎÇòÎèÑ ÌÖåÏä§Ìä∏ Ìï¥Î≥¥Í∏∞',
                    link: {
                        mobileWebUrl: window.location.href,
                        webUrl: window.location.href
                    }
                }
            ]
        });
    } catch (error) {
        console.error('Ïπ¥Ïπ¥Ïò§ÌÜ° Í≥µÏú† Ïò§Î•ò:', error);
        alert('Ïπ¥Ïπ¥Ïò§ÌÜ° Í≥µÏú† Í∏∞Îä•ÏùÑ ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏäµÎãàÎã§.');
    }
});

// Îã§Ïãú ÌÖåÏä§Ìä∏ÌïòÍ∏∞
restartBtn.addEventListener('click', function() {
    // Ï¥àÍ∏∞Ìôî
    currentQuestion = 0;
    answers = [];
    
    // Î™®Îì† ÏöîÏÜå Ïà®Í∏∞Í∏∞
    questions.forEach(q => q.style.display = 'none');
    result.style.display = 'none';
    analysisPopup.style.display = 'none';
    document.getElementById('questionMidAd').style.display = 'none';
    
    // Sticky Í¥ëÍ≥† ÏÉÅÌÉú Ï¥àÍ∏∞Ìôî
    const stickyAd = document.getElementById('stickyAd');
    localStorage.removeItem('stickyAdClosed');
    stickyAd.classList.remove('hidden');
    
    // ÏãúÏûë ÌôîÎ©¥ ÌëúÏãú
    document.querySelector('.question-container').style.display = 'block';
});

// ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú ÏÉÅÎã® Í¥ëÍ≥† Î°úÎìú
document.addEventListener('DOMContentLoaded', function() {
    // ÏÉÅÎã® Í¥ëÍ≥† Î°úÎìú
    setTimeout(() => {
        loadAds();
    }, 500);
    
    // Sticky Í¥ëÍ≥† Ï¥àÍ∏∞Ìôî
    initStickyAd();
});

// Sticky Í¥ëÍ≥† Ï¥àÍ∏∞Ìôî Î∞è Ï†úÏñ¥
function initStickyAd() {
    const stickyAd = document.getElementById('stickyAd');
    const stickyAdClose = document.getElementById('stickyAdClose');
    
    // Sticky Í¥ëÍ≥† Î°úÎìú
    setTimeout(() => {
        loadAds();
    }, 1000);
    
    // Îã´Í∏∞ Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
    stickyAdClose.addEventListener('click', function() {
        stickyAd.classList.add('hidden');
        // Î°úÏª¨Ïä§ÌÜ†Î¶¨ÏßÄÏóê Îã´Ìûò ÏÉÅÌÉú Ï†ÄÏû•
        localStorage.setItem('stickyAdClosed', 'true');
    });
    
    // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ïù¥Ï†ÑÏóê Îã´ÌòîÎçò ÏÉÅÌÉú ÌôïÏù∏
    if (localStorage.getItem('stickyAdClosed') === 'true') {
        stickyAd.classList.add('hidden');
    }
    
    // ÌéòÏù¥ÏßÄ Ïä§ÌÅ¨Î°§ Ïãú sticky Í¥ëÍ≥† ÌëúÏãú/Ïà®ÍπÄ (ÏÑ†ÌÉùÏÇ¨Ìï≠)
    let lastScrollTop = 0;
    window.addEventListener('scroll', function() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        
        // Ïä§ÌÅ¨Î°§ÏùÑ ÏïÑÎûòÎ°ú Ìï† ÎïåÎßå Ï≤¥ÌÅ¨ (ÏÇ¨Ïö©Ïûê Í≤ΩÌóò Í∞úÏÑ†)
        if (scrollTop > lastScrollTop && scrollTop > 300) {
            // Ïä§ÌÅ¨Î°§Ïù¥ 300px Ïù¥ÏÉÅÏùº ÎïåÎßå sticky Í¥ëÍ≥† ÌëúÏãú
            if (localStorage.getItem('stickyAdClosed') !== 'true') {
                stickyAd.classList.remove('hidden');
            }
        }
        
        lastScrollTop = scrollTop;
    }, false);
}
